handler和中间件调用的复杂功能